<template>
  <import from="./game-canvas"></import>
  <section>
    <div class="container-fluid">
      <div class="row">

        <div class="col-xs-8">

          <div class="well text-center">
            <game-canvas
              scene-config.bind="sceneConfig"
              model.two-way="M">
            </game-canvas>
          </div>

          <form class="well" submit.delegate="submitBackground( $event )">
            <fieldset if.bind="M.game.scene">
              <legend>
                Backgrounds
              </legend>
              <div class="row">
                <template repeat.for="bg of M.game.scene.backgrounds">
                  <u class="col-xs-12">Background ${($parent.$index+1)}</u>
                  <div class="form-group col-xs-3" repeat.for="key of bg.editablePropertyKeys()">
                    <label for="item-field-${key}">${key | capitalize}:</label>
                    <template if.bind="$parent.bg.editablePropertyConfig(key).type=='number'">
                      <input type="number" step.bind="$parent.bg.editablePropertyConfig(key).step" id="item-field-${key}" value.bind="$parent.bg[key]" class="form-control">
                    </template>
                    <template if.bind="$parent.bg.editablePropertyConfig(key).type=='text'">
                      <input type="text" id="item-field-${key}" value.bind="$parent.bg[key]" class="form-control">
                    </template>
                    <template if.bind="$parent.bg.editablePropertyConfig(key).type=='url'">
                      <input type="url" id="item-field-${key}" value.bind="$parent.bg[key]" class="form-control">
                    </template>
                  </div>
                </template>
              </div>
              <div class="text-right">
                <button type="submit" class="btn btn-primary">Save</button>
              </div>
            </fieldset>
          </form>

        </div>

        <div class="col-xs-4">
          <form class="well" submit.delegate="submitEntity( $event )">
            <fieldset if.bind="M.entity">
              <legend if.bind="!M.entity">
                Choose an item
              </legend>
              <legend if.bind="M.entity.id">
                ${M.entity.id | capitalize}
              </legend>
              <div class="row">
                <div class="form-group col-xs-6" repeat.for="key of M.entity.editablePropertyKeys()">
                  <label for="item-field-${key}">${key | capitalize}:</label>
                  <template if.bind="$parent.M.entity.editablePropertyConfig( key ).type=='number'">
                    <input type="number" step.bind="$parent.M.entity.editablePropertyConfig( key ).step" id="item-field-${key}" value.bind="$parent.M.entity[key]" class="form-control">
                  </template>
                  <template if.bind="$parent.M.entity.editablePropertyConfig( key ).type=='text'">
                    <input type="text" id="item-field-${key}" value.bind="$parent.M.entity[key]" class="form-control">
                  </template>
                  <template if.bind="$parent.M.entity.editablePropertyConfig( key ).type=='url'">
                    <input type="url" id="item-field-${key}" value.bind="$parent.M.entity[key]" class="form-control">
                  </template>
                </div>
              </div>
              <div class="text-right">
                <button type="submit" class="btn btn-primary">Save</button>
              </div>
            </fieldset>
          </form>
        </div>

      </div>
    </div>
  </section>
</template>
